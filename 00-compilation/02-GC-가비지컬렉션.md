# GC (Garbage Collection) – 가비지 컬렉션

JVM 메모리 다음으로, **힙에 쌓인 객체를 누가 어떻게 정리하는지** 정리했습니다. 면접에서 "GC 원리", "Minor/Major GC" 자주 나옵니다.

---

## GC가 뭐고, 왜 필요한가?

- **GC = Garbage Collection**  
  **더 이상 쓰지 않는 객체**를 찾아서 **힙 메모리에서 지우는** 작업입니다.
- **왜 필요하나?**  
  객체는 `new`로만 만들고, C처럼 "이제 안 쓸 거니까 메모리 해제해" 같은 코드를 직접 안 씁니다.  
  그대로 두면 힙이 가득 차서 **OutOfMemoryError**가 나기 때문에, JVM이 **자동으로** 안 쓰는 객체를 정리해 줍니다.

**한 줄**: 힙에서 **참조가 없어진 객체(가비지)**를 찾아 **메모리를 회수**하는 것 = GC.

---

## 어떤 메모리를 정리하나?

- **힙(Heap)**만 정리합니다.
- 스택은 메서드 끝나면 프레임이 pop 되어서 자동으로 비워지고,  
  메서드 영역은 클래스 정보라서 GC 대상이 아닙니다 (일반적인 GC 기준).

---

## "쓰지 않는 객체"는 어떻게 아나? (Reachability)

JVM은 **어디선가 참조가 이어져서 도달 가능한지**로 판단합니다.

- **도달 가능(Reachable)**  
  스택의 지역 변수, static 변수, 메서드 영역 등 **루트**에서 참조를 따라갔을 때 **닿는 객체**  
  → 이건 **살려 둠**.
- **도달 불가(Unreachable)**  
  어디에서도 참조하지 않아서 **닿을 수 없는 객체**  
  → 이건 **가비지**로 보고 **GC가 회수**함.

**예시**

```java
Person p = new Person();  // 힙에 객체 생성, p가 참조
p = null;                 // p가 더 이상 그 객체를 안 가리킴 → 그 객체는 도달 불가 → GC 대상
```

---

## 힙 구조와 Minor / Major GC (면접 단골)

JVM은 힙을 **나이에 따라** 구역을 나눕니다. (구현마다 이름이 조금 다를 수 있음.)

| 구역 | 설명 | GC 종류 |
|------|------|---------|
| **Young 영역** | 방금 생성된 객체 대부분 | **Minor GC** (Young GC) |
| **Old 영역** | 오래 살아남은 객체 | **Major GC** (Full GC) |

- **Minor GC**  
  Young 영역만 정리. **자주** 일어나고, **빠르게** 끝나는 편.
- **Major GC (Full GC)**  
  **전체 힙**(Young + Old)을 정리. **가끔** 일어나고, **오래 걸림** → 이때 애플리케이션 스레드가 멈추는 구간이 길어질 수 있음.

**면접 포인트**: "Minor GC와 Major GC 차이?"  
→ Minor = Young만, 자주·빠름 / Major = 전체 힙, 가끔·오래 걸림.

---

## GC 기본 동작 (Mark and Sweep 개념)

(실제로는 여러 방식이 있지만, 개념만 잡을 때는 이렇게 보면 됩니다.)

1. **Mark(표시)**  
   루트(스택, static 등)에서 시작해서 **도달 가능한 객체**를 전부 표시.
2. **Sweep(쓸기)**  
   표시 **안 된 객체** = 도달 불가 = 가비지 → **메모리 회수**.

---

## Stop-the-World (STW)

- GC가 돌아가는 동안 **애플리케이션 스레드는 잠시 멈춤** = **Stop-the-World**.
- Minor GC는 짧게 멈추고, **Full GC**는 길게 멈출 수 있어서 **지연(latency)** 이슈가 됩니다.
- 그래서 실무에서는 **GC 알고리즘 선택**(G1, ZGC 등)이나 **힙 크기 튜닝**으로 Full GC를 줄이는 걸 신경 씁니다.

---

## 정리 (면접 대답용)

1. **GC란?**  
   힙에서 **더 이상 참조되지 않는 객체(가비지)**를 찾아 **메모리를 회수**하는 것.

2. **어디를 정리하나?**  
   **힙**만. 스택/메서드 영역은 일반 GC 대상이 아님.

3. **쓰지 않는 객체 판단?**  
   **루트에서 참조가 이어져 도달 가능한지**로 판단. 도달 불가 = 가비지.

4. **Minor GC vs Major(Full) GC?**  
   Minor = Young 영역만, 자주·빠름. Major = 전체 힙, 가끔·오래 걸림.

5. **Stop-the-World?**  
   GC 동작 중에는 애플리케이션 스레드가 잠시 멈춤. Full GC일수록 멈춤이 길어짐.

---

다음으로 **OOP 4대 특성**(캡슐화, 상속, 다형성, 추상화)이나 **String/equals** 정리해두면 자바 면접 흐름 잡기 좋습니다.
