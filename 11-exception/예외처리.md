# 예외 처리 (Exception Handling)

실행 중 **뭔가 잘못됐을 때** JVM이 던지는 **에러 객체**를 **잡아서 처리**하는 게 예외 처리예요.  
try-catch로 잡으면 프로그램이 그대로 죽지 않고, 대체 동작을 하거나 로그를 남길 수 있어요.

---

## 1. try / catch / finally 기본

### 구조

```java
try {
    // 예외가 날 수 있는 코드
} catch (예외타입 e) {
    // 예외가 났을 때 처리
} finally {
    // 예외 나든 안 나든 (보통) 한 번은 실행 (선택)
}
```

### 예시 1: 숫자 파싱

```java
public static void main(String[] args) {
    try {
        String input = "abc";
        int num = Integer.parseInt(input);   // "abc"는 숫자 아님 → NumberFormatException
        System.out.println("숫자: " + num);
    } catch (NumberFormatException e) {
        System.out.println("숫자가 아닙니다. 메시지: " + e.getMessage());
    } finally {
        System.out.println("-- 처리 끝 --");
    }
}
// 출력:
// 숫자가 아닙니다. 메시지: For input string: "abc"
// -- 처리 끝 --
```

- **try** 안에서 `Integer.parseInt("abc")`가 **NumberFormatException**을 던짐.
- **catch**가 그 예외를 받아서 메시지만 출력.
- **finally**는 예외가 나든 안 나든 실행됨.

### 예시 2: 배열 인덱스

```java
int[] arr = { 10, 20, 30 };

try {
    System.out.println(arr[0]);   // 10
    System.out.println(arr[5]);   // 인덱스 5 없음 → ArrayIndexOutOfBoundsException
} catch (ArrayIndexOutOfBoundsException e) {
    System.out.println("잘못된 인덱스: " + e.getMessage());
}
```

### 예시 3: null 참조

```java
String str = null;

try {
    System.out.println(str.length());   // str이 null → NullPointerException
} catch (NullPointerException e) {
    System.out.println("null입니다.");
}
```

---

## 2. catch 여러 개 (예외 타입별 처리)

한 try에 **여러 catch**를 두면, **던져진 예외 타입에 맞는** catch가 실행돼요.

```java
try {
    int n = Integer.parseInt("123");   // 정상
    int[] a = { 1 };
    System.out.println(a[10]);        // ArrayIndexOutOfBoundsException
} catch (NumberFormatException e) {
    System.out.println("숫자 아님");
} catch (ArrayIndexOutOfBoundsException e) {
    System.out.println("인덱스 범위 초과");
} catch (Exception e) {
    System.out.println("그 외 예외: " + e.getMessage());
}
```

- **Exception**은 모든 예외의 부모라서, 맨 마지막에 두면 "그 외 전부" 처리할 수 있어요.
- 순서는 **구체적인 예외 → 넓은 예외(Exception)** 로 두는 게 좋아요.

---

## 3. Checked Exception vs Unchecked Exception

### 표로 보기

| 구분 | Checked Exception | Unchecked Exception |
|------|------------------|---------------------|
| **상속** | `Exception` 직계 (RuntimeException 제외) | `RuntimeException` 상속 |
| **컴파일** | 반드시 **try-catch** 또는 **throws** 선언 | 선언 안 해도 컴파일 됨 |
| **예시** | IOException, SQLException, ClassNotFoundException | NullPointerException, IllegalArgumentException, NumberFormatException |

### Checked 예시 – 반드시 처리하거나 선언

```java
// Checked: IOException. 이걸 그냥 던지면 컴파일 에러.
public void readFile() throws IOException {
    Files.readAllLines(Path.of("file.txt"));  // IOException 가능
}

// 호출하는 쪽에서 try-catch
public static void main(String[] args) {
    try {
        new MyClass().readFile();
    } catch (IOException e) {
        System.out.println("파일 읽기 실패: " + e.getMessage());
    }
}
```

- **throws IOException** = "이 메소드는 IOException을 던질 수 있으니, 호출하는 쪽에서 처리해라."
- 호출하는 쪽에서 **try-catch** 하거나, 또 **throws** 로 넘겨야 해요.

### Unchecked 예시 – 선언 없어도 됨

```java
// Unchecked: 선언 안 해도 컴파일 됨
public int divide(int a, int b) {
    return a / b;   // b가 0이면 ArithmeticException (Unchecked)
}
```

- **ArithmeticException**, **NullPointerException**, **IllegalArgumentException** 등은 **RuntimeException** 계열이라 **throws** 안 써도 됨.

---

## 4. throws – 예외를 호출한 쪽으로 넘기기

메소드 안에서 **직접 catch하지 않고**, "나를 부른 쪽에서 처리해라" 하고 넘길 때 **throws** 를 씁니다.

```java
// 예외를 처리하지 않고, 선언만 함
public String readFirstLine(String path) throws IOException {
    return Files.readAllLines(Path.of(path)).get(0);
}

// 호출하는 쪽에서 처리
public static void main(String[] args) {
    try {
        String line = readFirstLine("data.txt");
        System.out.println(line);
    } catch (IOException e) {
        System.out.println("파일 오류: " + e.getMessage());
    }
}
```

---

## 5. 예외 다시 던지기 (rethrow)

catch 안에서 **로그만 남기고**, 같은 예외를 다시 던질 수 있어요.

```java
public void process() throws IOException {
    try {
        readFile();
    } catch (IOException e) {
        System.err.println("로그: " + e.getMessage());
        throw e;   // 같은 예외를 다시 던짐 → 호출한 쪽에서 처리
    }
}
```

---

## 6. 면접용 정리

| 질문 | 답변 |
|------|------|
| try-catch-finally 역할? | **try** = 예외 나는 코드, **catch** = 예외 처리, **finally** = 정리(보통 한 번은 실행) |
| Checked vs Unchecked? | **Checked** = 반드시 try-catch 또는 throws. **Unchecked** = RuntimeException 계열, 선언 안 해도 됨. |
| throws? | "이 메소드는 이 예외를 던질 수 있으니, **호출한 쪽**에서 처리해라"는 선언. |

---

## 7. 자주 쓰는 예외 타입 (참고)

- **NullPointerException** – null 참조로 메소드/필드 접근
- **ArrayIndexOutOfBoundsException** – 배열 잘못된 인덱스
- **NumberFormatException** – 문자열을 숫자로 바꿀 수 없을 때 (parseInt 등)
- **IllegalArgumentException** – 인자가 잘못됐을 때 (직접 throw 할 때 많음)
- **IOException** – 입출력 오류 (Checked)

이 정도만 익혀 두면 예외 처리 흐름과 면접 대답에 충분해요.
